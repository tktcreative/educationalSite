<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balancing Chemical Equations - Interactive Science Lab</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* A very light gray */
        }
        .coeff-input {
            width: 60px;
            text-align: center;
            font-weight: bold;
            border: 2px solid #cbd5e1;
            border-radius: 0.5rem;
        }
        .atom-count-table td {
            padding: 8px 12px;
            text-align: center;
        }
    </style>
</head>
<body class="py-12 px-4 md:px-8">

    <!-- Main container -->
    <div class="max-w-7xl mx-auto">

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 tracking-tight">
                Balancing Chemical Equations
            </h1>
            <p class="text-lg text-gray-600 mt-3 max-w-3xl mx-auto">
                A fun game to help you practice balancing the atoms on both sides of a chemical equation.
            </p>
        </header>

        <!-- Simulation Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Left Panel: Information -->
            <div class="lg:col-span-1 bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Why Balance Equations?</h2>
                <p class="text-gray-600 mb-6">
                    The <strong>Law of Conservation of Mass</strong> states that matter cannot be created or destroyed. In a chemical reaction, this means the number of atoms of each element must be the same on both the reactant (left) and product (right) sides.
                </p>
                
                <h3 class="text-xl font-semibold text-gray-800 mb-3">How to Play:</h3>
                 <ul class="list-disc list-inside text-gray-700 space-y-2 mb-6">
                    <li>Select an equation from the dropdown menu.</li>
                    <li>Adjust the numbers (coefficients) in front of each molecule.</li>
                    <li>Watch the atom count table update in real-time.</li>
                    <li>The goal is to make the atom counts equal on both sides for all elements.</li>
                    <li>Click <strong>Check Answer</strong> when you think it's balanced!</li>
                </ul>
            </div>

            <!-- Right Panel: Interactive Simulation -->
            <div class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg border border-gray-200">
                <div class="flex justify-center mb-6">
                    <label for="equation-select" class="font-semibold text-gray-700 mr-2 self-center">Select Equation:</label>
                    <select id="equation-select" class="p-2 rounded-lg border-2">
                        <option value="h2o">Water Synthesis</option>
                        <option value="ch4">Methane Combustion</option>
                        <option value="photosynthesis">Photosynthesis</option>
                        <option value="respiration">Cellular Respiration</option>
                        <option value="rust">Iron Rusting</option>
                        <option value="haber">Haber Process (Ammonia)</option>
                        <option value="h2o2">Peroxide Decomposition</option>
                        <option value="zn_hcl">Zinc in Acid</option>
                        <option value="ag_nacl">Silver Nitrate + Salt</option>
                        <option value="neutralization">Neutralization</option>
                        <option value="caco3">Limestone Decomposition</option>
                        <option value="propane">Propane Combustion</option>
                        <option value="naoh">Sodium in Water</option>
                        <option value="fecl3">Iron (III) Chloride Synthesis</option>
                        <option value="p4">Phosphorus Combustion</option>
                    </select>
                </div>

                <!-- Equation Display -->
                <div id="equation-display" class="flex flex-wrap items-center justify-center text-2xl md:text-3xl font-bold mb-8 space-x-2">
                    <!-- Equation will be generated by JS here -->
                </div>

                <!-- Atom Count Table -->
                <div class="flex justify-center mb-8">
                    <table id="atom-count-table" class="atom-count-table bg-gray-50 rounded-lg">
                        <!-- Table content will be generated by JS here -->
                    </table>
                </div>

                <!-- Check Button and Message -->
                <div class="text-center">
                    <button id="check-btn" class="w-full md:w-1/2 bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">Check Answer</button>
                    <p id="message" class="mt-4 text-lg font-semibold h-6"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const equationDisplay = document.getElementById('equation-display');
        const atomCountTable = document.getElementById('atom-count-table');
        const equationSelect = document.getElementById('equation-select');
        const checkBtn = document.getElementById('check-btn');
        const messageEl = document.getElementById('message');

        const equationsData = {
            h2o: {
                reactants: [{ formula: 'H₂', atoms: { H: 2 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                solution: [2, 1, 2]
            },
            ch4: {
                reactants: [{ formula: 'CH₄', atoms: { C: 1, H: 4 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'CO₂', atoms: { C: 1, O: 2 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                solution: [1, 2, 1, 2]
            },
            photosynthesis: {
                reactants: [{ formula: 'CO₂', atoms: { C: 1, O: 2 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                products: [{ formula: 'C₆H₁₂O₆', atoms: { C: 6, H: 12, O: 6 } }, { formula: 'O₂', atoms: { O: 2 } }],
                solution: [6, 6, 1, 6]
            },
            respiration: {
                reactants: [{ formula: 'C₆H₁₂O₆', atoms: { C: 6, H: 12, O: 6 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'CO₂', atoms: { C: 1, O: 2 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                solution: [1, 6, 6, 6]
            },
            rust: {
                reactants: [{ formula: 'Fe', atoms: { Fe: 1 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'Fe₂O₃', atoms: { Fe: 2, O: 3 } }],
                solution: [4, 3, 2]
            },
            haber: {
                reactants: [{ formula: 'N₂', atoms: { N: 2 } }, { formula: 'H₂', atoms: { H: 2 } }],
                products: [{ formula: 'NH₃', atoms: { N: 1, H: 3 } }],
                solution: [1, 3, 2]
            },
            h2o2: {
                reactants: [{ formula: 'H₂O₂', atoms: { H: 2, O: 2 } }],
                products: [{ formula: 'H₂O', atoms: { H: 2, O: 1 } }, { formula: 'O₂', atoms: { O: 2 } }],
                solution: [2, 2, 1]
            },
            zn_hcl: {
                reactants: [{ formula: 'Zn', atoms: { Zn: 1 } }, { formula: 'HCl', atoms: { H: 1, Cl: 1 } }],
                products: [{ formula: 'ZnCl₂', atoms: { Zn: 1, Cl: 2 } }, { formula: 'H₂', atoms: { H: 2 } }],
                solution: [1, 2, 1, 1]
            },
            ag_nacl: {
                reactants: [{ formula: 'AgNO₃', atoms: { Ag: 1, N: 1, O: 3 } }, { formula: 'NaCl', atoms: { Na: 1, Cl: 1 } }],
                products: [{ formula: 'AgCl', atoms: { Ag: 1, Cl: 1 } }, { formula: 'NaNO₃', atoms: { Na: 1, N: 1, O: 3 } }],
                solution: [1, 1, 1, 1]
            },
            neutralization: {
                reactants: [{ formula: 'HCl', atoms: { H: 1, Cl: 1 } }, { formula: 'NaOH', atoms: { Na: 1, O: 1, H: 1 } }],
                products: [{ formula: 'NaCl', atoms: { Na: 1, Cl: 1 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                solution: [1, 1, 1, 1]
            },
            caco3: {
                reactants: [{ formula: 'CaCO₃', atoms: { Ca: 1, C: 1, O: 3 } }],
                products: [{ formula: 'CaO', atoms: { Ca: 1, O: 1 } }, { formula: 'CO₂', atoms: { C: 1, O: 2 } }],
                solution: [1, 1, 1]
            },
            propane: {
                reactants: [{ formula: 'C₃H₈', atoms: { C: 3, H: 8 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'CO₂', atoms: { C: 1, O: 2 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                solution: [1, 5, 3, 4]
            },
            naoh: {
                reactants: [{ formula: 'Na', atoms: { Na: 1 } }, { formula: 'H₂O', atoms: { H: 2, O: 1 } }],
                products: [{ formula: 'NaOH', atoms: { Na: 1, O: 1, H: 1 } }, { formula: 'H₂', atoms: { H: 2 } }],
                solution: [2, 2, 2, 1]
            },
            fecl3: {
                reactants: [{ formula: 'Fe', atoms: { Fe: 1 } }, { formula: 'Cl₂', atoms: { Cl: 2 } }],
                products: [{ formula: 'FeCl₃', atoms: { Fe: 1, Cl: 3 } }],
                solution: [2, 3, 2]
            },
            p4: {
                reactants: [{ formula: 'P₄', atoms: { P: 4 } }, { formula: 'O₂', atoms: { O: 2 } }],
                products: [{ formula: 'P₂O₅', atoms: { P: 2, O: 5 } }],
                solution: [1, 5, 2]
            }
        };

        let currentEquationKey;

        function parseFormula(formula) {
            return formula.replace(/(\d+)/g, '<sub>$1</sub>');
        }
        
        function createComponent(component, index) {
            const container = document.createElement('div');
            container.classList.add('flex', 'items-center', 'space-x-2', 'mb-2');
            
            const input = document.createElement('input');
            input.type = 'number';
            input.min = 1;
            input.value = 1;
            input.dataset.index = index;
            input.classList.add('coeff-input');
            input.addEventListener('input', updateCounts);

            const formulaSpan = document.createElement('span');
            formulaSpan.innerHTML = parseFormula(component.formula);
            
            container.appendChild(input);
            container.appendChild(formulaSpan);
            return container;
        }

        function loadEquation(key) {
            currentEquationKey = key;
            const data = equationsData[key];
            equationDisplay.innerHTML = '';
            
            let componentIndex = 0;

            data.reactants.forEach((r, i) => {
                equationDisplay.appendChild(createComponent(r, componentIndex++));
                if (i < data.reactants.length - 1) {
                    const plus = document.createElement('span');
                    plus.textContent = '+';
                    plus.classList.add('self-center', 'mb-2');
                    equationDisplay.appendChild(plus);
                }
            });

            const arrow = document.createElement('span');
            arrow.innerHTML = '&rarr;';
            arrow.classList.add('mx-4', 'self-center', 'mb-2');
            equationDisplay.appendChild(arrow);

            data.products.forEach((p, i) => {
                equationDisplay.appendChild(createComponent(p, componentIndex++));
                if (i < data.products.length - 1) {
                    const plus = document.createElement('span');
                    plus.textContent = '+';
                    plus.classList.add('self-center', 'mb-2');
                    equationDisplay.appendChild(plus);
                }
            });
            
            updateCounts();
        }

        function getAtomList(data) {
            const atoms = new Set();
            [...data.reactants, ...data.products].forEach(comp => {
                Object.keys(comp.atoms).forEach(atom => atoms.add(atom));
            });
            return Array.from(atoms);
        }

        function updateCounts() {
            messageEl.textContent = '';
            const data = equationsData[currentEquationKey];
            const coefficients = Array.from(equationDisplay.querySelectorAll('.coeff-input')).map(el => parseInt(el.value) || 1);
            const atomList = getAtomList(data);

            const counts = { reactants: {}, products: {} };
            atomList.forEach(atom => {
                counts.reactants[atom] = 0;
                counts.products[atom] = 0;
            });

            data.reactants.forEach((comp, i) => {
                for (const atom in comp.atoms) {
                    counts.reactants[atom] += (comp.atoms[atom] * coefficients[i]);
                }
            });

            data.products.forEach((comp, i) => {
                const coeffIndex = data.reactants.length + i;
                for (const atom in comp.atoms) {
                    counts.products[atom] += (comp.atoms[atom] * coefficients[coeffIndex]);
                }
            });

            // Render table
            atomCountTable.innerHTML = `
                <thead>
                    <tr class="bg-gray-200">
                        <th class="p-2">Element</th>
                        <th class="p-2">Reactants</th>
                        <th class="p-2">Products</th>
                    </tr>
                </thead>
                <tbody>
                    ${atomList.map(atom => {
                        const isBalanced = counts.reactants[atom] === counts.products[atom];
                        return `<tr class="${isBalanced ? 'bg-green-100' : 'bg-red-100'}">
                            <td class="font-bold">${atom}</td>
                            <td>${counts.reactants[atom]}</td>
                            <td>${counts.products[atom]}</td>
                        </tr>`;
                    }).join('')}
                </tbody>
            `;
        }

        function checkAnswer() {
            const data = equationsData[currentEquationKey];
            const userCoefficients = Array.from(equationDisplay.querySelectorAll('.coeff-input')).map(el => parseInt(el.value) || 1);
            
            const isCorrect = JSON.stringify(userCoefficients) === JSON.stringify(data.solution);

            if (isCorrect) {
                messageEl.textContent = 'Correct! Well done!';
                messageEl.classList.remove('text-red-600');
                messageEl.classList.add('text-green-600');
            } else {
                messageEl.textContent = 'Not quite balanced. Keep trying!';
                messageEl.classList.remove('text-green-600');
                messageEl.classList.add('text-red-600');
            }
        }

        equationSelect.addEventListener('change', (e) => loadEquation(e.target.value));
        checkBtn.addEventListener('click', checkAnswer);

        loadEquation('h2o');

    </script>
</body>
</html>
